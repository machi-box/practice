<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    
</body>

<script>
    var midi;
 
//通信成功時
function success(midiAccess){
    midi = midiAccess;
    console.log("MIDI READY");
    setInputs(midiAccess);
}
 
//通信失敗時
function failure(msg){
    console.log("MIDI FAILED - " + msg);
}
 
//MIDIAccessオブジェクトのInputsを取得してイベントに対して関数を渡す
function setInputs(midiAccess){
    var inputs = midiAccess.inputs;
    inputs.forEach(function(key,port){
        console.log("[" + key.state + "] manufacturer:" + key.manufacturer + " / name:" + key.name + " / port:" + port);
        key.onmidimessage = onMidiMessage;
    });
}
 
//MIDIデバイスからメッセージが送られる時に実行
function onMidiMessage(event){
    console.log(event);
    var str = '';
    for (var i = 0; i < event.data.length; i++) {
        str += event.data[i] + ':';
    }
    console.log(str);
}
 
//MIDIデバイスへアクセスする
navigator.requestMIDIAccess()
    .then(success, failure);
    
    </script>
</html>